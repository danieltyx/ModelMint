{"version":3,"file":"metadataHelpers.esm.js","sources":["../src/utils.ts","../src/MetadataStorageLayer.ts","../src/webAuthnShareResolver.ts"],"sourcesContent":[null,null,null],"names":["keccak256","a","Buffer","from","keccakHash","ec","EC","MetadataStorageLayer","constructor","metadataHost","arguments","length","undefined","serverTimeOffset","_defineProperty","setAPIKey","apiKey","setEmbedHost","embedHost","generateMetadataParams","message","privateKeyHex","key","keyFromPrivate","setData","data","timestamp","Math","floor","Date","now","toString","sig","sign","stringify","pub_key_X","getPublic","getX","pub_key_Y","getY","set_data","signature","r","s","recoveryParam","padStart","slice","generatePubKeyParams","setMetadata","namespace","options","params","_objectSpread","metadataResponse","post","useAPIKey","getMetadata","pubKey","WEBAUTHN_TORUS_SHARE","WEBAUTHN_DEVICE_SHARE","encParamsHexToBuf","encParamsHex","iv","ephemPublicKey","ciphertext","mac","encParamsBufToHex","encParams","encryptData","privKeyHex","d","serializedDec","JSON","serializedBuf","encrypt","sData","decryptData","parse","keyPair","decrypt","getPrivate","getAndDecryptData","m","serializedData","encryptAndSetData","metadataParams","setTorusShare","webAuthnPubKey","webAuthnRefHex","subspace","subspaceData","refKeyPair","privKey","keyFromPublic","x","y","serializedSubspaceData","serializedSubspaceDataBuf","encSubspaceData","encSubspaceDataHex","setDeviceShare","getTorusShare","webAuthnKeyHex","getDeviceShare"],"mappings":";;;;;;;AAGM,SAAUA,SAASA,CAACC,CAAS,EAAA;EACjC,OAAOC,MAAM,CAACC,IAAI,CAACC,WAAU,CAACH,CAAC,CAAC,CAAC,CAAA;AACnC,CAAA;MAEaI,EAAE,GAAG,IAAIC,IAAE,CAAC,WAAW;;;;ACWpC,MAAMC,oBAAoB,CAAA;AAGS;AAEjCC,EAAAA,WAAAA,GAA0E;AAAA,IAAA,IAA9DC,YAAY,GAAAC,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAG,yBAAyB,CAAA;AAAA,IAAA,IAAEG,gBAAgB,GAAAH,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAG,CAAC,CAAA;IAAAI,eAAA,CAAA,IAAA,EAAA,cAAA,EAAA,KAAA,CAAA,CAAA,CAAA;IAAAA,eAAA,CAAA,IAAA,EAAA,kBAAA,EAAA,KAAA,CAAA,CAAA,CAAA;IACxE,IAAI,CAACL,YAAY,GAAGA,YAAY,CAAA;IAChC,IAAI,CAACI,gBAAgB,GAAGA,gBAAgB,CAAA;AAC1C,GAAA;EAEA,OAAOE,SAASA,CAACC,MAAc,EAAA;IAC7BD,SAAS,CAACC,MAAM,CAAC,CAAA;AACnB,GAAA;EAEA,OAAOC,YAAYA,CAACC,SAAiB,EAAA;IACnCD,YAAY,CAACC,SAAS,CAAC,CAAA;AACzB,GAAA;AAEAC,EAAAA,sBAAsBA,CAACC,OAAe,EAAEC,aAAqB,EAAA;IAC3D,MAAMC,GAAG,GAAGjB,EAAE,CAACkB,cAAc,CAACF,aAAa,EAAE,KAAK,CAAC,CAAA;AACnD,IAAA,MAAMG,OAAO,GAAG;AACdC,MAAAA,IAAI,EAAEL,OAAO;AACbM,MAAAA,SAAS,EAAEC,IAAI,CAACC,KAAK,CAAC,IAAI,CAACf,gBAAgB,GAAGgB,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAA;KAC7E,CAAA;IACD,MAAMC,GAAG,GAAGV,GAAG,CAACW,IAAI,CAACjC,SAAS,CAACE,MAAM,CAACC,IAAI,CAAC+B,SAAS,CAACV,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAA;IACxE,OAAO;AACLW,MAAAA,SAAS,EAAEb,GAAG,CAACc,SAAS,EAAE,CAACC,IAAI,EAAE,CAACN,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;AAClDO,MAAAA,SAAS,EAAEhB,GAAG,CAACc,SAAS,EAAE,CAACG,IAAI,EAAE,CAACR,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;AAClDS,MAAAA,QAAQ,EAAEhB,OAAO;MACjBiB,SAAS,EAAEvC,MAAM,CAACC,IAAI,CACpB6B,GAAG,CAACU,CAAC,CAACX,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,GAAGC,GAAG,CAACW,CAAC,CAACZ,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,IAAIC,GAAG,CAACY,aAAa,EAAEb,QAAQ,CAAC,EAAE,CAAC,CAACc,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,EACtH,KAAK,CACN,CAACf,QAAQ,CAAC,QAAQ,CAAA;KACpB,CAAA;AACH,GAAA;EAEAgB,oBAAoBA,CAAC1B,aAAqB,EAAA;IACxC,MAAMC,GAAG,GAAGjB,EAAE,CAACkB,cAAc,CAACF,aAAa,EAAE,KAAK,CAAC,CAAA;IACnD,OAAO;AACLc,MAAAA,SAAS,EAAEb,GAAG,CAACc,SAAS,EAAE,CAACC,IAAI,EAAE,CAACN,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;AAClDO,MAAAA,SAAS,EAAEhB,GAAG,CAACc,SAAS,EAAE,CAACG,IAAI,EAAE,CAACR,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAA;KAClD,CAAA;AACH,GAAA;AAEA,EAAA,MAAMiB,WAAWA,CAACvB,IAAoB,EAAEwB,SAAwB,EAAEC,OAAqB,EAAA;IACrF,MAAMC,MAAM,GAAGF,SAAS,KAAK,IAAI,GAAAG,aAAA,CAAAA,aAAA,CAAA,EAAA,EAAQ3B,IAAI,CAAA,EAAA,EAAA,EAAA;AAAEwB,MAAAA,SAAAA;AAAS,KAAA,CAAA,GAAKxB,IAAI,CAAA;AACjE,IAAA,MAAM4B,gBAAgB,GAAG,MAAMC,IAAI,CAAyB,CAAA,EAAA,IAAI,CAAC7C,YAAY,CAAM,IAAA,CAAA,EAAE0C,MAAM,EAAED,OAAO,EAAE;AAAEK,MAAAA,SAAS,EAAE,IAAA;AAAM,KAAA,CAAC,CAAA;IAC1H,OAAOF,gBAAgB,CAACjC,OAAO,CAAA;AACjC,GAAA;AAEA,EAAA,MAAMoC,WAAWA,CAACC,MAAoB,EAAER,SAAwB,EAAEC,OAAqB,EAAA;IACrF,MAAMC,MAAM,GAAGF,SAAS,KAAK,IAAI,GAAAG,aAAA,CAAAA,aAAA,CAAA,EAAA,EAAQK,MAAM,CAAA,EAAA,EAAA,EAAA;AAAER,MAAAA,SAAAA;AAAS,KAAA,CAAA,GAAKQ,MAAM,CAAA;AACrE,IAAA,MAAMJ,gBAAgB,GAAG,MAAMC,IAAI,CAAyB,CAAA,EAAA,IAAI,CAAC7C,YAAY,CAAM,IAAA,CAAA,EAAE0C,MAAM,EAAED,OAAO,EAAE;AAAEK,MAAAA,SAAS,EAAE,IAAA;AAAM,KAAA,CAAC,CAAA;IAC1H,OAAOF,gBAAgB,CAACjC,OAAO,CAAA;AACjC,GAAA;AACD;;ACpED,MAAMsC,oBAAoB,GAAG,sBAAsB,CAAA;AACnD,MAAMC,qBAAqB,GAAG,uBAAuB,CAAA;AAS/C,SAAUC,iBAAiBA,CAACC,YAAsB,EAAA;EACtD,OAAO;IACLC,EAAE,EAAE5D,MAAM,CAACC,IAAI,CAAC0D,YAAY,CAACC,EAAE,EAAE,KAAK,CAAC;IACvCC,cAAc,EAAE7D,MAAM,CAACC,IAAI,CAAC0D,YAAY,CAACE,cAAc,EAAE,KAAK,CAAC;IAC/DC,UAAU,EAAE9D,MAAM,CAACC,IAAI,CAAC0D,YAAY,CAACG,UAAU,EAAE,KAAK,CAAC;IACvDC,GAAG,EAAE/D,MAAM,CAACC,IAAI,CAAC0D,YAAY,CAACI,GAAG,EAAE,KAAK,CAAA;GACzC,CAAA;AACH,CAAA;AAEM,SAAUC,iBAAiBA,CAACC,SAAgB,EAAA;EAChD,OAAO;AACLL,IAAAA,EAAE,EAAE5D,MAAM,CAACC,IAAI,CAACgE,SAAS,CAACL,EAAE,CAAC,CAAC/B,QAAQ,CAAC,KAAK,CAAC;AAC7CgC,IAAAA,cAAc,EAAE7D,MAAM,CAACC,IAAI,CAACgE,SAAS,CAACJ,cAAc,CAAC,CAAChC,QAAQ,CAAC,KAAK,CAAC;AACrEiC,IAAAA,UAAU,EAAE9D,MAAM,CAACC,IAAI,CAACgE,SAAS,CAACH,UAAU,CAAC,CAACjC,QAAQ,CAAC,KAAK,CAAC;AAC7DkC,IAAAA,GAAG,EAAE/D,MAAM,CAACC,IAAI,CAACgE,SAAS,CAACF,GAAG,CAAC,CAAClC,QAAQ,CAAC,KAAK,CAAA;GAC/C,CAAA;AACH,CAAA;AAEO,eAAeqC,WAAWA,CAACC,UAAkB,EAAEC,CAAU,EAAA;AAC9D,EAAA,MAAMC,aAAa,GAAGC,IAAI,CAACtC,SAAS,CAACoC,CAAC,CAAC,CAAA;EACvC,MAAMG,aAAa,GAAGvE,MAAM,CAACC,IAAI,CAACoE,aAAa,EAAE,OAAO,CAAC,CAAA;AACzD,EAAA,MAAMJ,SAAS,GAAG,MAAMO,OAAO,CAACtC,SAAS,CAAClC,MAAM,CAACC,IAAI,CAACkE,UAAU,EAAE,KAAK,CAAC,CAAC,EAAEI,aAAa,CAAC,CAAA;AACzF,EAAA,MAAMZ,YAAY,GAAGK,iBAAiB,CAACC,SAAS,CAAC,CAAA;AACjD,EAAA,MAAMQ,KAAK,GAAGH,IAAI,CAACtC,SAAS,CAAC2B,YAAY,CAAC,CAAA;AAC1C,EAAA,OAAOc,KAAK,CAAA;AACd,CAAA;AAEO,eAAeC,WAAWA,CAAIP,UAAkB,EAAEC,CAAS,EAAA;AAChE,EAAA,MAAMT,YAAY,GAAaW,IAAI,CAACK,KAAK,CAACP,CAAC,CAAC,CAAA;AAC5C,EAAA,MAAMH,SAAS,GAAGP,iBAAiB,CAACC,YAAY,CAAC,CAAA;AACjD,EAAA,MAAMiB,OAAO,GAAGzE,EAAE,CAACkB,cAAc,CAAC8C,UAAU,CAAC,CAAA;EAC7C,MAAMI,aAAa,GAAG,MAAMM,OAAO,CAAC7E,MAAM,CAACC,IAAI,CAAC2E,OAAO,CAACE,UAAU,EAAE,CAACjD,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,KAAK,CAAC,EAAEoC,SAAS,CAAC,CAAA;AAC5G,EAAA,MAAMI,aAAa,GAAGE,aAAa,CAAC1C,QAAQ,CAAC,OAAO,CAAC,CAAA;AACrD,EAAA,MAAMN,IAAI,GAAM+C,IAAI,CAACK,KAAK,CAACN,aAAa,CAAC,CAAA;AACzC,EAAA,OAAO9C,IAAI,CAAA;AACb,CAAA;AAEO,eAAewD,iBAAiBA,CAAIC,CAAuB,EAAEb,UAAkB,EAAEpB,SAAiB,EAAA;AACvG,EAAA,MAAM6B,OAAO,GAAGzE,EAAE,CAACkB,cAAc,CAAC8C,UAAU,CAAC,CAAA;AAC7C,EAAA,MAAMZ,MAAM,GAAGqB,OAAO,CAAC1C,SAAS,EAAE,CAAA;AAClC,EAAA,MAAM+C,cAAc,GAAG,MAAMD,CAAC,CAAC1B,WAAW,CAAC;IAAErB,SAAS,EAAEsB,MAAM,CAACpB,IAAI,EAAE,CAACN,QAAQ,CAAC,EAAE,CAAC;IAAEO,SAAS,EAAEmB,MAAM,CAAClB,IAAI,EAAE,CAACR,QAAQ,CAAC,EAAE,CAAA;GAAG,EAAEkB,SAAS,CAAC,CAAA;EACvI,IAAI,CAACkC,cAAc,EAAE;AACnB,IAAA,OAAO,IAAI,CAAA;AACZ,GAAA;EACD,MAAM1D,IAAI,GAAG,MAAMmD,WAAW,CAAIP,UAAU,EAAEc,cAAc,CAAC,CAAA;AAC7D,EAAA,OAAO1D,IAAyB,CAAA;AAClC,CAAA;AAEO,eAAe2D,iBAAiBA,CAACF,CAAuB,EAAEb,UAAkB,EAAEC,CAA0B,EAAErB,SAAiB,EAAA;EAChI,MAAM0B,KAAK,GAAG,MAAMP,WAAW,CAACC,UAAU,EAAEC,CAAC,CAAC,CAAA;EAC9C,MAAMe,cAAc,GAAGH,CAAC,CAAC/D,sBAAsB,CAACwD,KAAK,EAAEN,UAAU,CAAC,CAAA;AAClE,EAAA,MAAMa,CAAC,CAAClC,WAAW,CAACqC,cAAc,EAAEpC,SAAS,CAAC,CAAA;AAChD,CAAA;AAEO,eAAeqC,aAAaA,CACjCJ,CAAuB,EACvBK,cAA4B,EAC5BC,cAAsB,EACtBC,QAAgB,EAChBC,YAAqB,EAAA;AAErB,EAAA,MAAMC,UAAU,GAAGtF,EAAE,CAACkB,cAAc,CAACiE,cAAc,CAAC,CAAA;AACpD,EAAA,MAAMI,OAAO,GAAGD,UAAU,CAACX,UAAU,EAAE,CAAA;AACvC,EAAA,MAAMvB,MAAM,GAAGpD,EAAE,CAACwF,aAAa,CAAC;IAC9BC,CAAC,EAAEP,cAAc,CAACpD,SAAS;IAC3B4D,CAAC,EAAER,cAAc,CAACjD,SAAAA;AACnB,GAAA,CAAC,CAAA;EACF,MAAMb,IAAI,GAAG,MAAMwD,iBAAiB,CAACC,CAAC,EAAEM,cAAc,EAAE9B,oBAAoB,CAAC,CAAA;EAC7E,IAAIY,CAAC,GAA4B,EAAE,CAAA;AACnC,EAAA,IAAI7C,IAAI,EAAE6C,CAAC,GAAG7C,IAAI,CAAA;AAClB,EAAA,MAAMuE,sBAAsB,GAAGxB,IAAI,CAACtC,SAAS,CAACwD,YAAY,CAAC,CAAA;EAC3D,MAAMO,yBAAyB,GAAG/F,MAAM,CAACC,IAAI,CAAC6F,sBAAsB,EAAE,OAAO,CAAC,CAAA;EAC9E,MAAME,eAAe,GAAG,MAAMxB,OAAO,CAACxE,MAAM,CAACC,IAAI,CAACsD,MAAM,CAACrB,SAAS,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE6D,yBAAyB,CAAC,CAAA;AAC7G,EAAA,MAAME,kBAAkB,GAAGjC,iBAAiB,CAACgC,eAAe,CAAC,CAAA;AAC7D5B,EAAAA,CAAC,CAACmB,QAAQ,CAAC,GAAGU,kBAAkB,CAAA;AAChC,EAAA,MAAMf,iBAAiB,CAACF,CAAC,EAAEU,OAAO,CAAC7D,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,EAAEuC,CAAC,EAAEZ,oBAAoB,CAAC,CAAA;AAClF,CAAA;AAEO,eAAe0C,cAAcA,CAAClB,CAAuB,EAAEM,cAAsB,EAAEC,QAAgB,EAAEC,YAAqB,EAAA;AAC3H,EAAA,MAAMZ,OAAO,GAAGzE,EAAE,CAACkB,cAAc,CAACiE,cAAc,CAAC,CAAA;AACjD,EAAA,MAAMI,OAAO,GAAGd,OAAO,CAACE,UAAU,EAAE,CAAA;EACpC,MAAMvD,IAAI,GAAG,MAAMwD,iBAAiB,CAACC,CAAC,EAAEM,cAAc,EAAE7B,qBAAqB,CAAC,CAAA;EAC9E,IAAIW,CAAC,GAA4B,EAAE,CAAA;AACnC,EAAA,IAAI7C,IAAI,EAAE6C,CAAC,GAAG7C,IAAI,CAAA;AAClB6C,EAAAA,CAAC,CAACmB,QAAQ,CAAC,GAAGC,YAAY,CAAA;AAC1B,EAAA,MAAMN,iBAAiB,CAACF,CAAC,EAAEU,OAAO,CAAC7D,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,EAAEuC,CAAC,EAAEX,qBAAqB,CAAC,CAAA;AACnF,CAAA;AAEO,eAAe0C,aAAaA,CAAInB,CAAuB,EAAEoB,cAAsB,EAAEd,cAAsB,EAAEC,QAAgB,EAAA;EAC9H,MAAMhE,IAAI,GAAG,MAAMwD,iBAAiB,CAAWC,CAAC,EAAEM,cAAc,EAAE9B,oBAAoB,CAAC,CAAA;AACvF,EAAA,IAAI,CAACjC,IAAI,EAAE,OAAO,IAAI,CAAA;AACtB,EAAA,MAAMoC,YAAY,GAAGpC,IAAI,CAACgE,QAAQ,CAAC,CAAA;AACnC,EAAA,IAAI,CAAC5B,YAAY,EAAE,OAAO,IAAI,CAAA;AAC9B,EAAA,MAAMM,SAAS,GAAGP,iBAAiB,CAACC,YAAY,CAAC,CAAA;AACjD,EAAA,MAAMiB,OAAO,GAAGzE,EAAE,CAACkB,cAAc,CAAC+E,cAAc,CAAC,CAAA;AACjD,EAAA,MAAMV,OAAO,GAAGd,OAAO,CAACE,UAAU,EAAE,CAAA;EACpC,MAAMiB,yBAAyB,GAAG,MAAMlB,OAAO,CAAC7E,MAAM,CAACC,IAAI,CAACyF,OAAO,CAAC7D,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,KAAK,CAAC,EAAEoC,SAAS,CAAC,CAAA;AAC3G,EAAA,MAAM6B,sBAAsB,GAAGC,yBAAyB,CAAClE,QAAQ,CAAC,OAAO,CAAC,CAAA;AAC1E,EAAA,MAAM2D,YAAY,GAAGlB,IAAI,CAACK,KAAK,CAACmB,sBAAsB,CAAC,CAAA;AACvD,EAAA,OAAON,YAAY,CAAA;AACrB,CAAA;AAEO,eAAea,cAAcA,CAAIrB,CAAuB,EAAEM,cAAsB,EAAEC,QAAgB,EAAA;EACvG,MAAMhE,IAAI,GAAG,MAAMwD,iBAAiB,CAAIC,CAAC,EAAEM,cAAc,EAAE7B,qBAAqB,CAAC,CAAA;AACjF,EAAA,IAAIlC,IAAI,EAAE,OAAOA,IAAI,CAACgE,QAAQ,CAAC,CAAA;AAC/B,EAAA,OAAO,IAAI,CAAA;AACb;;;;"}